# –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≥–µ–Ω—Ç–∞

from addedFunc import sendMessageToYandexGPT
from addedFunc import get_html
from addedFunc import ErrorHandler
import requests
import json





# –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã:
# 1. –ü–æ–ª—É—á–µ–Ω–∏–µ:
#   * –¢–ó –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ –ø—É–Ω–∫—Ç–∞–º
#   * –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–∞–π—Ç
#   * –¢–∞–±–ª–∏—á–∫–∏ —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–∞–Ω–Ω—ã–º–∏
# 2. –ê–≥–µ–Ω—Ç –ø—Ä–æ–±—É–µ—Ç –∑–∞–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –∏ –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π html
# 3. –ê–≥–µ–Ω—Ç —Ä–∞–∑–±–∏—Ä–∞–µ—Ç —Ç–∞–±–ª–∏—á–∫—É –∏ –¢–ó –≤ JSON —Ñ–æ—Ä–º–∞—Ç

# # ------------------

# print("–°—Ç–∞–¥–∏—è 2: –ü—Ä–æ–±—É–µ–º –∑–∞–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –∏ –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π html")

# url = "https://vodomirural.ru"
# html = get_html(url)
# print(html[:500])  # –í—ã–≤–µ–¥–µ–º –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –∫–æ–Ω—Å–æ–ª—å
# # print(html) 
# if(len(html) < 500): print("–û—Ç–≤–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–µ–Ω: –°–ª–∏—à–∫–æ–º –º–∞–ª–∞—è –¥–ª–∏–Ω–∞")
# # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–∞—Ö —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º

# # ------------------

# 4. –ó–∞—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–µ—Ä–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∏–ª–∏ —á–∞—Å—Ç—å. –ï—Å–ª–∏ –¥–∞ - —Ç–æ –æ–∫, –∏–¥—ë–º –¥–∞–ª—å—à–µ
# –≠—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ, —á—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞ –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –±–µ–∑ –∑–∞—â–∏—Ç—ã

# url_first_item = "https://vodomirural.ru/catalog/vanny_stalnye_i_aksessuary_k_nim/33951/"

# –î–∞–Ω–Ω—ã–µ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
data_input_table = {
    "links": {
        "simple": [
            {
                "link": "https://vodomirural.ru/catalog/vanny_stalnye_i_aksessuary_k_nim/33951/",
                "name": "–í–∞–Ω–Ω–∞ —Å—Ç–∞–ª—å 1600—Ö700—Ö400–º–º antika –±–µ–ª—ã–π –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ —Å –Ω–æ–∂–∫–∞–º–∏ –í–ò–ó –≤ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–µ",
                "price": "10 320",
                "inStock": True    
            }
        ]
    },
    "search_requests": []
}
# TODO: –ü–æ—Ç–æ–º –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É, —á—Ç–æ –±—ã –æ–Ω –∏—Å–∫–∞–ª –Ω–µ –ø–æ–ª–Ω—ã–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ, –∞ —á–∞—Å—Ç–∏—á–Ω—ã–º
# –≠—Ç–æ –∫–æ–≥–¥–∞ –Ω–∞–ø–∏—à—É —Ç–∞–∫—É—é —Ç—É–∫—É –¥–ª—è price

first_item_link = data_input_table["links"]["simple"][0]["link"]
# print(first_item_link)
html = get_html(first_item_link)
print(html[:500])

text_includes = data_input_table["links"]["simple"][0]["name"]
if text_includes in html:
    print("üü¢ –ü–æ–¥—Å—Ç—Ä–æ–∫–∞ –Ω–∞–π–¥–µ–Ω–∞!")
else:
    print("üü† –ü–æ–¥—Å—Ç—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
    raise ErrorHandler("–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã 1 —Ç–æ–≤–∞—Ä–∞, –Ω–∞ –Ω–µ–π –Ω–µ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞", "4-1")